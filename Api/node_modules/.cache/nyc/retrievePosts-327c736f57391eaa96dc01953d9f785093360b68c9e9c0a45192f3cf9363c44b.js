function cov_dsivzyd4o(){var path="/Users/mario/Desktop/FinalProyect/Api/logic/retrievePosts.js";var hash="61794d59ebb4265e61a308bba88129246118133d";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/mario/Desktop/FinalProyect/Api/logic/retrievePosts.js",statementMap:{"0":{start:{line:4,column:4},end:{line:4,column:18}},"1":{start:{line:5,column:23},end:{line:5,column:51}},"2":{start:{line:7,column:0},end:{line:45,column:1}},"3":{start:{line:8,column:4},end:{line:8,column:33}},"4":{start:{line:10,column:4},end:{line:44,column:6}},"5":{start:{line:18,column:8},end:{line:18,column:70}},"6":{start:{line:18,column:19},end:{line:18,column:70}},"7":{start:{line:19,column:8},end:{line:41,column:10}},"8":{start:{line:20,column:12},end:{line:20,column:41}},"9":{start:{line:21,column:12},end:{line:21,column:27}},"10":{start:{line:23,column:12},end:{line:23,column:27}},"11":{start:{line:25,column:12},end:{line:25,column:74}},"12":{start:{line:25,column:47},end:{line:25,column:73}},"13":{start:{line:27,column:12},end:{line:30,column:13}},"14":{start:{line:28,column:16},end:{line:28,column:59}},"15":{start:{line:29,column:16},end:{line:29,column:38}},"16":{start:{line:32,column:12},end:{line:40,column:14}},"17":{start:{line:33,column:16},end:{line:33,column:51}},"18":{start:{line:34,column:16},end:{line:34,column:34}},"19":{start:{line:36,column:16},end:{line:39,column:17}},"20":{start:{line:37,column:20},end:{line:37,column:69}},"21":{start:{line:38,column:20},end:{line:38,column:45}},"22":{start:{line:43,column:8},end:{line:43,column:20}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:7,column:17},end:{line:7,column:18}},loc:{start:{line:7,column:29},end:{line:45,column:1}},line:7},"1":{name:"(anonymous_1)",decl:{start:{line:17,column:12},end:{line:17,column:13}},loc:{start:{line:17,column:31},end:{line:44,column:5}},line:17},"2":{name:"(anonymous_2)",decl:{start:{line:19,column:22},end:{line:19,column:23}},loc:{start:{line:19,column:32},end:{line:41,column:9}},line:19},"3":{name:"(anonymous_3)",decl:{start:{line:25,column:38},end:{line:25,column:39}},loc:{start:{line:25,column:47},end:{line:25,column:73}},line:25},"4":{name:"(anonymous_4)",decl:{start:{line:32,column:34},end:{line:32,column:35}},loc:{start:{line:32,column:47},end:{line:40,column:13}},line:32}},branchMap:{"0":{loc:{start:{line:18,column:8},end:{line:18,column:70}},type:"if",locations:[{start:{line:18,column:8},end:{line:18,column:70}},{start:{line:18,column:8},end:{line:18,column:70}}],line:18},"1":{loc:{start:{line:27,column:12},end:{line:30,column:13}},type:"if",locations:[{start:{line:27,column:12},end:{line:30,column:13}},{start:{line:27,column:12},end:{line:30,column:13}}],line:27},"2":{loc:{start:{line:36,column:16},end:{line:39,column:17}},type:"if",locations:[{start:{line:36,column:16},end:{line:39,column:17}},{start:{line:36,column:16},end:{line:39,column:17}}],line:36}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0},b:{"0":[0,0],"1":[0,0],"2":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"61794d59ebb4265e61a308bba88129246118133d"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_dsivzyd4o=function(){return actualCoverage;};}return actualCoverage;}cov_dsivzyd4o();const{validators:{validateId},errors:{ExistenceError}}=(cov_dsivzyd4o().s[0]++,require('com'));const{User,Post}=(cov_dsivzyd4o().s[1]++,require('../data/models.js'));cov_dsivzyd4o().s[2]++;module.exports=userId=>{cov_dsivzyd4o().f[0]++;cov_dsivzyd4o().s[3]++;validateId(userId,'user id');cov_dsivzyd4o().s[4]++;return Promise.all([User.findById(userId).lean(),Post.find().sort('-date').populate('author','name avatar').populate('comments.author','name avatar').lean()]).then(([user,posts])=>{cov_dsivzyd4o().f[1]++;cov_dsivzyd4o().s[5]++;if(!user){cov_dsivzyd4o().b[0][0]++;cov_dsivzyd4o().s[6]++;throw new Error(`user with id ${userId} not found`);}else{cov_dsivzyd4o().b[0][1]++;}cov_dsivzyd4o().s[7]++;posts.forEach(post=>{cov_dsivzyd4o().f[2]++;cov_dsivzyd4o().s[8]++;post.id=post._id.toString();cov_dsivzyd4o().s[9]++;delete post._id;cov_dsivzyd4o().s[10]++;delete post.__v;cov_dsivzyd4o().s[11]++;post.fav=user.favs.some(fav=>{cov_dsivzyd4o().f[3]++;cov_dsivzyd4o().s[12]++;return fav.toString()===post.id;});cov_dsivzyd4o().s[13]++;if(post.author._id){cov_dsivzyd4o().b[1][0]++;cov_dsivzyd4o().s[14]++;post.author.id=post.author._id.toString();cov_dsivzyd4o().s[15]++;delete post.author._id;}else{cov_dsivzyd4o().b[1][1]++;}cov_dsivzyd4o().s[16]++;post.comments.forEach(comment=>{cov_dsivzyd4o().f[4]++;cov_dsivzyd4o().s[17]++;comment.id=comment._id.toString();cov_dsivzyd4o().s[18]++;delete comment._id;cov_dsivzyd4o().s[19]++;if(comment.author._id){cov_dsivzyd4o().b[2][0]++;cov_dsivzyd4o().s[20]++;comment.author.id=comment.author._id.toString();cov_dsivzyd4o().s[21]++;delete comment.author._id;}else{cov_dsivzyd4o().b[2][1]++;}});});cov_dsivzyd4o().s[22]++;return posts;});};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfZHNpdnp5ZDRvIiwiYWN0dWFsQ292ZXJhZ2UiLCJ2YWxpZGF0b3JzIiwidmFsaWRhdGVJZCIsImVycm9ycyIsIkV4aXN0ZW5jZUVycm9yIiwicyIsInJlcXVpcmUiLCJVc2VyIiwiUG9zdCIsIm1vZHVsZSIsImV4cG9ydHMiLCJ1c2VySWQiLCJmIiwiUHJvbWlzZSIsImFsbCIsImZpbmRCeUlkIiwibGVhbiIsImZpbmQiLCJzb3J0IiwicG9wdWxhdGUiLCJ0aGVuIiwidXNlciIsInBvc3RzIiwiYiIsIkVycm9yIiwiZm9yRWFjaCIsInBvc3QiLCJpZCIsIl9pZCIsInRvU3RyaW5nIiwiX192IiwiZmF2IiwiZmF2cyIsInNvbWUiLCJhdXRob3IiLCJjb21tZW50cyIsImNvbW1lbnQiXSwic291cmNlcyI6WyJyZXRyaWV2ZVBvc3RzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHtcbiAgICB2YWxpZGF0b3JzOiB7IHZhbGlkYXRlSWQgfSxcbiAgICBlcnJvcnM6IHsgRXhpc3RlbmNlRXJyb3IgfSxcbn0gPSByZXF1aXJlKCdjb20nKVxuY29uc3QgeyBVc2VyLCBQb3N0IH0gPSByZXF1aXJlKCcuLi9kYXRhL21vZGVscy5qcycpXG5cbm1vZHVsZS5leHBvcnRzID0gKHVzZXJJZCkgPT4ge1xuICAgIHZhbGlkYXRlSWQodXNlcklkLCAndXNlciBpZCcpXG5cbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW1xuICAgICAgICBVc2VyLmZpbmRCeUlkKHVzZXJJZCkubGVhbigpLFxuICAgICAgICBQb3N0LmZpbmQoKVxuICAgICAgICAgICAgLnNvcnQoJy1kYXRlJylcbiAgICAgICAgICAgIC5wb3B1bGF0ZSgnYXV0aG9yJywgJ25hbWUgYXZhdGFyJylcbiAgICAgICAgICAgIC5wb3B1bGF0ZSgnY29tbWVudHMuYXV0aG9yJywgJ25hbWUgYXZhdGFyJylcbiAgICAgICAgICAgIC5sZWFuKCksXG4gICAgXSkudGhlbigoW3VzZXIsIHBvc3RzXSkgPT4ge1xuICAgICAgICBpZiAoIXVzZXIpIHRocm93IG5ldyBFcnJvcihgdXNlciB3aXRoIGlkICR7dXNlcklkfSBub3QgZm91bmRgKVxuICAgICAgICBwb3N0cy5mb3JFYWNoKChwb3N0KSA9PiB7XG4gICAgICAgICAgICBwb3N0LmlkID0gcG9zdC5faWQudG9TdHJpbmcoKVxuICAgICAgICAgICAgZGVsZXRlIHBvc3QuX2lkXG5cbiAgICAgICAgICAgIGRlbGV0ZSBwb3N0Ll9fdlxuXG4gICAgICAgICAgICBwb3N0LmZhdiA9IHVzZXIuZmF2cy5zb21lKChmYXYpID0+IGZhdi50b1N0cmluZygpID09PSBwb3N0LmlkKVxuXG4gICAgICAgICAgICBpZiAocG9zdC5hdXRob3IuX2lkKSB7XG4gICAgICAgICAgICAgICAgcG9zdC5hdXRob3IuaWQgPSBwb3N0LmF1dGhvci5faWQudG9TdHJpbmcoKVxuICAgICAgICAgICAgICAgIGRlbGV0ZSBwb3N0LmF1dGhvci5faWRcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcG9zdC5jb21tZW50cy5mb3JFYWNoKChjb21tZW50KSA9PiB7XG4gICAgICAgICAgICAgICAgY29tbWVudC5pZCA9IGNvbW1lbnQuX2lkLnRvU3RyaW5nKClcbiAgICAgICAgICAgICAgICBkZWxldGUgY29tbWVudC5faWRcblxuICAgICAgICAgICAgICAgIGlmIChjb21tZW50LmF1dGhvci5faWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29tbWVudC5hdXRob3IuaWQgPSBjb21tZW50LmF1dGhvci5faWQudG9TdHJpbmcoKVxuICAgICAgICAgICAgICAgICAgICBkZWxldGUgY29tbWVudC5hdXRob3IuX2lkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfSlcblxuICAgICAgICByZXR1cm4gcG9zdHNcbiAgICB9KVxufVxuIl0sIm1hcHBpbmdzIjoiKzFHQWVZO0FBQUFBLGFBQUEsU0FBQUEsQ0FBQSxTQUFBQyxjQUFBLFdBQUFBLGNBQUEsRUFBQUQs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