function cov_5sof6b372(){var path="/Users/mario/Desktop/FinalProyect/Api/logic/authenticateUser.js";var hash="fe06af5118c37788bd22f037b2b5bd18ab7ebe67";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/mario/Desktop/FinalProyect/Api/logic/authenticateUser.js",statementMap:{"0":{start:{line:4,column:4},end:{line:4,column:18}},"1":{start:{line:5,column:17},end:{line:5,column:42}},"2":{start:{line:21,column:0},end:{line:37,column:1}},"3":{start:{line:22,column:4},end:{line:22,column:24}},"4":{start:{line:23,column:4},end:{line:23,column:30}},"5":{start:{line:25,column:4},end:{line:36,column:8}},"6":{start:{line:26,column:21},end:{line:26,column:50}},"7":{start:{line:28,column:8},end:{line:28,column:61}},"8":{start:{line:28,column:19},end:{line:28,column:61}},"9":{start:{line:30,column:8},end:{line:33,column:13}},"10":{start:{line:31,column:12},end:{line:33,column:13}},"11":{start:{line:35,column:8},end:{line:35,column:22}}},fnMap:{"0":{name:"authenticateUser",decl:{start:{line:21,column:26},end:{line:21,column:42}},loc:{start:{line:21,column:60},end:{line:37,column:1}},line:21},"1":{name:"(anonymous_1)",decl:{start:{line:25,column:12},end:{line:25,column:13}},loc:{start:{line:25,column:24},end:{line:36,column:5}},line:25}},branchMap:{"0":{loc:{start:{line:28,column:8},end:{line:28,column:61}},type:"if",locations:[{start:{line:28,column:8},end:{line:28,column:61}},{start:{line:28,column:8},end:{line:28,column:61}}],line:28},"1":{loc:{start:{line:30,column:8},end:{line:33,column:13}},type:"if",locations:[{start:{line:30,column:8},end:{line:33,column:13}},{start:{line:30,column:8},end:{line:33,column:13}}],line:30}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},f:{"0":0,"1":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"fe06af5118c37788bd22f037b2b5bd18ab7ebe67"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_5sof6b372=function(){return actualCoverage;};}return actualCoverage;}cov_5sof6b372();const{validators:{validateEmail,validatePassword},errors:{ExistenceError,AuthError}}=(cov_5sof6b372().s[0]++,require('com'));const{User}=(cov_5sof6b372().s[1]++,require('../data/models'));/**
 *Authenticate a user against his/her credentials
 * @param {string} email
 * @param {string} password
 *
 * @returns {Promise<string>} the userId
 *
 * @throws {TypeError} On non-string email or password
 * @throws {ContentError} On empty or blanck email or password
 * @throws {AuthError} On wrong credentials
 * @throws {ExistenceError} On non-existing user
 * @throws {RangeError} On password lenght not between 8 and 16 characters
 **/cov_5sof6b372().s[2]++;module.exports=function authenticateUser(email,password){cov_5sof6b372().f[0]++;cov_5sof6b372().s[3]++;validateEmail(email);cov_5sof6b372().s[4]++;validatePassword(password);cov_5sof6b372().s[5]++;return(async()=>{cov_5sof6b372().f[1]++;const user=(cov_5sof6b372().s[6]++,await User.findOne({email}));cov_5sof6b372().s[7]++;if(!user){cov_5sof6b372().b[0][0]++;cov_5sof6b372().s[8]++;throw new ExistenceError('User not found');}else{cov_5sof6b372().b[0][1]++;}cov_5sof6b372().s[9]++;if(user.password!==password){cov_5sof6b372().b[1][0]++;cov_5sof6b372().s[10]++;throw new AuthError('Password must be at least 8 characters long and contain a special character and a number');}else{cov_5sof6b372().b[1][1]++;}cov_5sof6b372().s[11]++;return user.id;})();};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfNXNvZjZiMzcyIiwiYWN0dWFsQ292ZXJhZ2UiLCJ2YWxpZGF0b3JzIiwidmFsaWRhdGVFbWFpbCIsInZhbGlkYXRlUGFzc3dvcmQiLCJlcnJvcnMiLCJFeGlzdGVuY2VFcnJvciIsIkF1dGhFcnJvciIsInMiLCJyZXF1aXJlIiwiVXNlciIsIm1vZHVsZSIsImV4cG9ydHMiLCJhdXRoZW50aWNhdGVVc2VyIiwiZW1haWwiLCJwYXNzd29yZCIsImYiLCJ1c2VyIiwiZmluZE9uZSIsImIiLCJpZCJdLCJzb3VyY2VzIjpbImF1dGhlbnRpY2F0ZVVzZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3Qge1xuICAgIHZhbGlkYXRvcnM6IHsgdmFsaWRhdGVFbWFpbCwgdmFsaWRhdGVQYXNzd29yZCB9LFxuICAgIGVycm9yczogeyBFeGlzdGVuY2VFcnJvciwgQXV0aEVycm9yIH0sXG59ID0gcmVxdWlyZSgnY29tJylcbmNvbnN0IHsgVXNlciB9ID0gcmVxdWlyZSgnLi4vZGF0YS9tb2RlbHMnKVxuXG4vKipcbiAqQXV0aGVudGljYXRlIGEgdXNlciBhZ2FpbnN0IGhpcy9oZXIgY3JlZGVudGlhbHNcbiAqIEBwYXJhbSB7c3RyaW5nfSBlbWFpbFxuICogQHBhcmFtIHtzdHJpbmd9IHBhc3N3b3JkXG4gKlxuICogQHJldHVybnMge1Byb21pc2U8c3RyaW5nPn0gdGhlIHVzZXJJZFxuICpcbiAqIEB0aHJvd3Mge1R5cGVFcnJvcn0gT24gbm9uLXN0cmluZyBlbWFpbCBvciBwYXNzd29yZFxuICogQHRocm93cyB7Q29udGVudEVycm9yfSBPbiBlbXB0eSBvciBibGFuY2sgZW1haWwgb3IgcGFzc3dvcmRcbiAqIEB0aHJvd3Mge0F1dGhFcnJvcn0gT24gd3JvbmcgY3JlZGVudGlhbHNcbiAqIEB0aHJvd3Mge0V4aXN0ZW5jZUVycm9yfSBPbiBub24tZXhpc3RpbmcgdXNlclxuICogQHRocm93cyB7UmFuZ2VFcnJvcn0gT24gcGFzc3dvcmQgbGVuZ2h0IG5vdCBiZXR3ZWVuIDggYW5kIDE2IGNoYXJhY3RlcnNcbiAqKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBhdXRoZW50aWNhdGVVc2VyKGVtYWlsLCBwYXNzd29yZCkge1xuICAgIHZhbGlkYXRlRW1haWwoZW1haWwpXG4gICAgdmFsaWRhdGVQYXNzd29yZChwYXNzd29yZClcblxuICAgIHJldHVybiAoYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlci5maW5kT25lKHsgZW1haWwgfSlcblxuICAgICAgICBpZiAoIXVzZXIpIHRocm93IG5ldyBFeGlzdGVuY2VFcnJvcignVXNlciBub3QgZm91bmQnKVxuXG4gICAgICAgIGlmICh1c2VyLnBhc3N3b3JkICE9PSBwYXNzd29yZClcbiAgICAgICAgICAgIHRocm93IG5ldyBBdXRoRXJyb3IoXG4gICAgICAgICAgICAgICAgJ1Bhc3N3b3JkIG11c3QgYmUgYXQgbGVhc3QgOCBjaGFyYWN0ZXJzIGxvbmcgYW5kIGNvbnRhaW4gYSBzcGVjaWFsIGNoYXJhY3RlciBhbmQgYSBudW1iZXInXG4gICAgICAgICAgICApXG5cbiAgICAgICAgcmV0dXJuIHVzZXIuaWRcbiAgICB9KSgpXG59XG4iXSwibWFwcGluZ3MiOiJnaEVBZVk7QUFBQUEsYUFBQSxTQUFBQSxDQUFBLFNBQUFDLGNBQUEsV0FBQUEsY0FBQSxFQUFBRCxhQUFBLEdBZlosS0FBTSxDQUNGRSxVQUFVLENBQUUsQ0FBRUMsYUFBYSxDQUFFQyxnQkFBaUIsQ0FBQyxDQUMvQ0MsTUFBTSxDQUFFLENBQUVDLGNBQWMsQ0FBRUMsU0FBVSxDQUN4QyxDQUFDLEVBQUFQLGFBQUEsR0FBQVEsQ0FBQSxNQUFHQyxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQ2xCLEtBQU0sQ0FBRUMsSUFBSyxDQUFDLEVBQUFWLGFBQUEsR0FBQVEsQ0FBQSxNQUFHQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsRUFFMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFaQVQsYUFBQSxHQUFBUSxDQUFBLE1BY0FHLE1BQU0sQ0FBQ0MsT0FBTyxDQUFHLFFBQVMsQ0FBQUMsZ0JBQWdCQSxDQUFDQyxLQUFLLENBQUVDLFFBQVEsQ0FBRSxDQUFBZixhQUFBLEdBQUFnQixDQUFBLE1BQUFoQixhQUFBLEdBQUFRLENBQUEsTUFDeERMLGFBQWEsQ0FBQ1csS0FBSyxDQUFDLENBQUFkLGFBQUEsR0FBQVEsQ0FBQSxNQUNwQkosZ0JBQWdCLENBQUNXLFFBQVEsQ0FBQyxDQUFBZixhQUFBLEdBQUFRLENBQUEsTUFFMUIsTUFBTyxDQUFDLFNBQVksQ0FBQVIsYUFBQSxHQUFBZ0IsQ0FBQSxNQUNoQixLQUFNLENBQUFDLElBQUksRUFBQWpCLGFBQUEsR0FBQVEsQ0FBQSxNQUFHLEtBQU0sQ0FBQUUsSUFBSSxDQUFDUSxPQUFPLENBQUMsQ0FBRUosS0FBTSxDQUFDLENBQUMsRUFBQWQsYUFBQSxHQUFBUSxDQUFBLE1BRTFDLEdBQUksQ0FBQ1MsSUFBSSxDQUFFLENBQUFqQixhQUFBLEdBQUFtQixDQUFBLFNBQUFuQixhQUFBLEdBQUFRLENBQUEsV0FBTSxJQUFJLENBQUFGLGNBQWMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFELENBQUMsS0FBQU4sYUFBQSxHQUFBbUIsQ0FBQSxVQUFBbkIsYUFBQSxHQUFBUSxDQUFBLE1BRXJELEdBQUlTLElBQUksQ0FBQ0YsUUFBUSxHQUFLQSxRQUFRLENBQzFCLENBQUFmLGFBQUEsR0FBQW1CLENBQUEsU0FBQW5CLGFBQUEsR0FBQVEsQ0FBQSxZQUFNLElBQUksQ0FBQUQsU0FBUyxDQUNmLDBGQUNKLENBQUMsQ0FBRCxDQUFDLEtBQUFQLGFBQUEsR0FBQW1CLENBQUEsVUFBQW5CLGFBQUEsR0FBQVEsQ0FBQSxPQUVMLE1BQU8sQ0FBQVMsSUFBSSxDQUFDRyxFQUFFLENBQ2xCLENBQUMsRUFBRSxDQUFDLENBQ1IsQ0FBQyJ9